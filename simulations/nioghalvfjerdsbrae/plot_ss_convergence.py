from numpy import *
import matplotlib        as mpl
import matplotlib.pyplot as plt

mpl.rcParams['font.family']          = 'serif'
#mpl.rcParams['legend.fontsize']      = 'medium'
mpl.rcParams['text.usetex']          = True
mpl.rcParams['text.latex.preamble']  = ['\usepackage[mathscr]{euscript}']

u_rel_1 = [0.423757,    0.00222204,  7.25835e-05, 4.79592e-05, 3.14722e-05,
           2.06329e-05, 1.35312e-05, 8.87911e-06, 5.82979e-06, 3.8296e-06,
           2.51669e-06, 1.65443e-06, 1.08788e-06, 7.15486e-07, 4.70644e-07,
           3.09627e-07, 2.03718e-07, 1.34046e-07, 8.82075e-08, 5.80469e-08,
           3.82004e-08, 2.51403e-08, 1.65457e-08]

u_rel_2 = [0.423771,    0.00236884,  2.21539e-05, 2.59259e-07, 1.33903e-08,
           8.83387e-09, 5.82592e-09, 3.84256e-09, 2.53572e-09, 1.67442e-09,
           1.10588e-09, 7.30655e-10, 4.83106e-10, 3.19408e-10, 2.11545e-10,
           1.39778e-10, 9.26766e-11, 6.23767e-11, 4.36487e-11, 3.18147e-11,
           2.72188e-11, 2.2769e-11,  1.53298e-11, 1.7043e-11,  1.05784e-11,
           1.12786e-11, 1.19701e-11, 1.1317e-11,  1.95833e-11, 2.75303e-11,
           1.03351e-11, 2.11103e-11, 1.86588e-11, 1.55062e-11, 1.48877e-11,
           1.38988e-11]

u_rel_3 = [0.423772,    0.00236883,  2.21592e-05, 2.5578e-07,  3.57314e-09,
           1.67943e-10, 1.08061e-10, 7.20389e-11, 4.95317e-11, 4.75193e-11,
           3.10394e-11, 3.07838e-11, 3.11373e-11, 1.60204e-11, 1.23936e-11,
           2.40742e-11, 1.16913e-11, 7.09393e-12, 3.97504e-11]

t_rel_1 = [0.0276905,   0.000355194, 9.40467e-06, 2.7998e-06,  1.59069e-06,
           1.01179e-06, 6.54566e-07, 4.25212e-07, 2.76701e-07, 1.80261e-07,
           1.17537e-07, 7.66975e-08, 5.00821e-08, 3.27228e-08, 2.13925e-08,
           1.39924e-08, 9.15645e-09, 5.9944e-09,  3.92586e-09, 2.57205e-09,
           1.68566e-09, 1.10508e-09, 7.24667e-10]

t_rel_2 = [0.0276906,   0.000357614, 1.02644e-05, 3.05495e-07, 8.10148e-09,
           1.54363e-09, 5.14832e-10, 2.52877e-10, 1.48538e-10, 9.31868e-11,
           5.99046e-11, 3.88844e-11, 2.53555e-11, 1.65653e-11, 1.08525e-11,
           7.10206e-12, 4.65543e-12, 3.05188e-12, 2.02721e-12, 1.36765e-12,
           8.76001e-13, 6.08874e-13, 4.11999e-13, 3.09625e-13, 2.21059e-13,
           2.09625e-13, 2.14241e-13, 1.72748e-13, 1.04722e-13, 1.26164e-13,
           7.97146e-14, 1.88218e-13, 1.19999e-13, 1.22384e-13, 1.0576e-13,
           3.17885e-13]

t_rel_3 = [0.0276906,   0.000357614, 1.02645e-05, 3.06183e-07, 9.15243e-09,
           2.42047e-10, 4.42486e-11, 1.26385e-11, 4.87916e-12, 2.36919e-12,
           1.31846e-12, 8.6621e-13,  5.55385e-13, 5.04699e-13, 2.47233e-13,
           3.39457e-13, 1.91227e-13, 1.63186e-13, 3.53364e-13]

u_reltol = [1e-2, 1e-7, 1e-9]
colors   = ['k',  'r',  '#7e47b1']

u_rel = [u_rel_1, u_rel_2, u_rel_3]
t_rel = [t_rel_1, t_rel_2, t_rel_3]
for i, (u,t,c,tol) in enumerate(zip(u_rel, t_rel, colors, u_reltol)):
	plt.semilogy(u, lw=2.0, ls='-',  c=c,
	             label=r'$\underline{u}$: \texttt{reltol = %.1e}' % tol)
	plt.semilogy(t, lw=2.0, ls='--', c=c,
	             label=r'$T$')

plt.grid()
plt.legend()
plt.tight_layout()
plt.show()
